var app = angular.module('app',['ngRoute'])

.controller('LoginCtrl', function($scope,$http) {



  $scope.login = function(user) {
   console.log(user);
   $http.post('http://localhost:8080/api/open' + '/login', user).success(function(response,status, headers, config) {
      //console.log(headers('Authorization'));
	  sessionStorage.token = headers('Authorization');
	  $http.defaults.headers.common['Authorization'] = sessionStorage.token;
    })
};

  $scope.register = function(user) {

$http.post('http://localhost:8080/api/open' + '/account',user).success(function(data){
                                                                 			$scope.user = {};
                                                                 		}).error(function(error){
                                                                 			$scope.erro = error;
                                                                 		});
};


 $scope.logout = function () {
 $http.put('http://localhost:8080/api/secured' + '/logout').success(function(data){
                                                                  			delete sessionStorage.token;
                                                                  		}).error(function(error){
                                                                  			$scope.erro = error;
                                                                  		});


  };

 $scope.isauthenticated = function() {
   return sessionStorage.token;
  };
 
});
